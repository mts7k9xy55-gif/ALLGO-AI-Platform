<body>

    <div id="chat"></div>
    
    <div id="input">
      <input id="text" placeholder="ç­”ãˆã‚‹...">
      <button onclick="send()">Send</button>
    </div>
    
    <!-- ğŸ‘‡ script ã¯å¿…ãšæœ€å¾Œ -->
    <script>
    const API = "https://wandering-dream-51c5allgoai-api.rgvr8syq2x.workers.dev";
    
    let spec = {
      purpose:"",
      target_users:"",
      features:[],
      ui_style:"",
      constraints:[],
      decided:false
    };
    
    const chat = document.getElementById("chat");
    
    function addMsg(text, cls){
      const d=document.createElement("div");
      d.className="msg "+cls;
      d.textContent=text;
      chat.appendChild(d);
      chat.scrollTop=chat.scrollHeight;
    }
    
    async function aiRespond(userText){
      const res = await fetch(API + "/llm", {
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body: JSON.stringify({ spec, message:userText })
      });
      return await res.json();
    }
    
    async function send(){
      const t = document.getElementById("text");
      const text = t.value.trim();
      if(!text) return;
      t.value="";
    
      addMsg(text,"user");
    
      const res = await aiRespond(text);
      addMsg(res.reply,"ai");
    
      spec = res.spec;
    
      if(spec.decided){
        const btn=document.createElement("button");
        btn.textContent="ã‚¢ãƒ—ãƒªã‚’ç”Ÿæˆã™ã‚‹";
        btn.onclick=()=>location.href="earth.html";
        chat.appendChild(btn);
      }
    }
    
    addMsg("ã©ã‚“ãªã‚¢ãƒ—ãƒªã‚’ä½œã‚ŠãŸã„ï¼Ÿ","ai");
    </script>
    
    </body>
    