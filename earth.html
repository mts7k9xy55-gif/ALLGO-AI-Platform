<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>ALLGOAI Earth</title>

<style>
body {
  margin:0;
  background:#0e0e11;
  color:#eee;
  font-family: system-ui;
}

header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:14px 20px;
  background:#16161d;
}

header button {
  background:#3a6bff;
  border:none;
  color:white;
  padding:8px 14px;
  border-radius:6px;
  cursor:pointer;
}

#app-list {
  display:grid;
  grid-template-columns: repeat(auto-fill,minmax(220px,1fr));
  gap:16px;
  padding:20px;
}

.app-card {
  background:#1b1b22;
  border-radius:12px;
  padding:16px;
  position:relative;
}

.app-title {
  font-size:16px;
  font-weight:600;
  margin-bottom:6px;
}

.app-desc {
  font-size:13px;
  opacity:.7;
  margin-bottom:12px;
}

.app-card button {
  background:#3a6bff;
  border:none;
  color:white;
  padding:6px 10px;
  border-radius:6px;
  cursor:pointer;
}

.delete-btn {
  position:absolute;
  top:8px;
  right:8px;
  background:none;
  border:none;
  font-size:14px;
  opacity:.6;
  cursor:pointer;
}
</style>
</head>

<body>

<header>
  <h1>ALLGOAI Earth</h1>
  <button onclick="location.href='blackhole.html'">Create</button>
</header>

<div id="app-list"></div>

<script src="util.js"></script>
<script>
async function renderApps(){
  const data = await getApps();

  // â˜… ã“ã“ãŒä¿®æ­£ãƒã‚¤ãƒ³ãƒˆ
  const apps = Array.isArray(data) ? data : (data.results || []);

  const container = document.getElementById("app-list");
  container.innerHTML = "";

  apps.forEach(app=>{
    const div = document.createElement("div");
    div.className="app-card";
    div.innerHTML=`
      <div class="app-title">${app.title || app.name}</div>
      <div class="app-desc">${app.description || ""}</div>
      <button class="open-btn">Open</button>
      <button class="delete-btn">ðŸ—‘</button>
    `;

    div.querySelector(".open-btn").onclick=()=>{
      location.href = "admin.html?id="+app.id;
    };

    div.querySelector(".delete-btn").onclick=async()=>{
      await deleteApp(app.id);
      renderApps();
    };

    container.appendChild(div);
  });
}

renderApps();
</script>
</body>
</html>
