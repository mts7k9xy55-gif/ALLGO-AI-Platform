<h2>App Preview</h2>
<iframe id="frame" style="width:100%;height:80vh;border:none;"></iframe>
<br>
<button id="install">â¬‡ Install PWA</button>

<script src="util.js"></script>
<script>
let deferredPrompt;

window.addEventListener("beforeinstallprompt", e=>{
  e.preventDefault();
  deferredPrompt = e;
});

document.getElementById("install").onclick = async ()=>{
  if(deferredPrompt){
    deferredPrompt.prompt();
  }
};

async function load(){
  const id = new URL(location.href).searchParams.get("id");
  const app = await getApp(id);
  const files = JSON.parse(app.files);
  document.getElementById("frame").srcdoc = files["index.html"];
}
load();
</script>
